{
  "version": 3,
  "sources": ["../../../../../../Users/alexcapsunel/Documents/GitHub/capsuna_work/netlify/functions/meetings.js", "../../../../../../Users/alexcapsunel/Documents/GitHub/capsuna_work/netlify/functions/utils/db.js", "../../../../../../Users/alexcapsunel/Documents/GitHub/capsuna_work/netlify/functions/models/Meeting.js"],
  "sourceRoot": "/var/folders/d6/2tbmdwln2p15fyp3qmqj0dt80000gn/T/tmp-18744-hxCZeZAe3q5I",
  "sourcesContent": ["import connectToDatabase from './utils/db.js';\nimport Meeting from './models/Meeting.js';\n\nexport const handler = async (event, context) => {\n  // Make the database connection available for reuse\n  context.callbackWaitsForEmptyEventLoop = false;\n  \n  console.log(`Meetings API: ${event.httpMethod} ${event.path}`);\n  \n  try {\n    // Connect to database\n    const db = await connectToDatabase();\n    console.log('Database connection established');\n    \n    // Handle different HTTP methods\n    switch (event.httpMethod) {\n      case 'GET':\n        if (event.path === '/.netlify/functions/meetings') {\n          // Get all meetings\n          console.log('Getting all meetings');\n          const meetings = await Meeting.find();\n          console.log(`Found ${meetings.length} meetings`);\n          return {\n            statusCode: 200,\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(meetings)\n          };\n        } else {\n          // Get single meeting by ID (from path parameter)\n          const id = event.path.split('/').pop();\n          console.log(`Getting meeting with ID: ${id}`);\n          const meeting = await Meeting.findOne({ id });\n          \n          if (!meeting) {\n            console.log(`Meeting not found with ID: ${id}`);\n            return {\n              statusCode: 404,\n              body: JSON.stringify({ message: 'Meeting not found' })\n            };\n          }\n          \n          console.log('Meeting found:', meeting.title);\n          return {\n            statusCode: 200,\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(meeting)\n          };\n        }\n      \n      case 'POST':\n        // Create a new meeting\n        const meetingData = JSON.parse(event.body);\n        console.log('Creating new meeting:', JSON.stringify(meetingData));\n        \n        const newMeeting = new Meeting(meetingData);\n        console.log('Meeting model created, saving to database...');\n        \n        const savedMeeting = await newMeeting.save();\n        console.log('Meeting saved to database with ID:', savedMeeting.id);\n        \n        return {\n          statusCode: 201,\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(savedMeeting)\n        };\n      \n      case 'PUT':\n        // Update a meeting\n        const updateId = event.path.split('/').pop();\n        const updateData = JSON.parse(event.body);\n        console.log(`Updating meeting ${updateId}:`, JSON.stringify(updateData));\n        \n        const updatedMeeting = await Meeting.findOneAndUpdate(\n          { id: updateId },\n          updateData,\n          { new: true }\n        );\n        \n        if (!updatedMeeting) {\n          console.log(`Meeting not found for update with ID: ${updateId}`);\n          return {\n            statusCode: 404,\n            body: JSON.stringify({ message: 'Meeting not found' })\n          };\n        }\n        \n        console.log('Meeting updated:', updatedMeeting.title);\n        return {\n          statusCode: 200,\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(updatedMeeting)\n        };\n      \n      case 'DELETE':\n        // Delete a meeting\n        const deleteId = event.path.split('/').pop();\n        console.log(`Deleting meeting with ID: ${deleteId}`);\n        \n        const deletedMeeting = await Meeting.findOneAndDelete({ id: deleteId });\n        \n        if (!deletedMeeting) {\n          console.log(`Meeting not found for deletion with ID: ${deleteId}`);\n          return {\n            statusCode: 404,\n            body: JSON.stringify({ message: 'Meeting not found' })\n          };\n        }\n        \n        console.log('Meeting deleted successfully');\n        return {\n          statusCode: 200,\n          body: JSON.stringify({ message: 'Meeting deleted' })\n        };\n      \n      default:\n        // Method not allowed\n        console.log(`Method not allowed: ${event.httpMethod}`);\n        return {\n          statusCode: 405,\n          body: JSON.stringify({ message: 'Method not allowed' })\n        };\n    }\n  } catch (error) {\n    console.error('Error in meetings function:', error);\n    return {\n      statusCode: 500,\n      body: JSON.stringify({ \n        message: 'Server error', \n        error: error.message,\n        stack: error.stack \n      })\n    };\n  }\n}; ", "import mongoose from 'mongoose';\n\nlet cachedDb = null;\n\nasync function connectToDatabase() {\n  if (cachedDb) {\n    return cachedDb;\n  }\n\n  // Get MongoDB URI from environment\n  const mongoUri = process.env.REACT_APP_MONGODB_URI;\n  \n  // Validate URI exists\n  if (!mongoUri) {\n    const error = new Error(\n      'REACT_APP_MONGODB_URI environment variable is not set. ' +\n      'Please configure it in your Netlify dashboard under Site settings > Environment variables.'\n    );\n    console.error(error.message);\n    throw error;\n  }\n\n  // Connection options\n  const options = {\n    dbName: 'capsuna_work' // Explicitly set the database name\n  };\n\n  try {\n    console.log('Connecting to MongoDB...');\n    console.log('MongoDB URI:', mongoUri.replace(/\\/\\/([^:]+):([^@]+)@/, '//$1:****@')); // Log without password\n    \n    const conn = await mongoose.connect(mongoUri, options);\n    cachedDb = conn;\n    console.log('MongoDB connected successfully to database:', conn.connection.db.databaseName);\n    return cachedDb;\n  } catch (error) {\n    console.error('MongoDB connection error:', error);\n    throw error;\n  }\n}\n\nexport default connectToDatabase; ", "import mongoose from 'mongoose';\n\nconst MeetingSchema = new mongoose.Schema({\n  id: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  title: {\n    type: String,\n    required: true\n  },\n  description: {\n    type: String,\n    default: ''\n  },\n  date: {\n    type: Date,\n    required: true\n  },\n  duration: {\n    type: Number,\n    required: true,\n    default: 30 // in minutes\n  },\n  participants: {\n    type: [String],\n    default: []\n  },\n  notes: {\n    type: String,\n    default: ''\n  },\n  completed: {\n    type: Boolean,\n    default: false\n  }\n}, {\n  collection: 'meetings', // Explicitly set collection name\n  timestamps: true // Adds createdAt and updatedAt timestamps\n});\n\n// Use existing model if it exists, otherwise create a new one\nconst Meeting = mongoose.models.Meeting || mongoose.model('Meeting', MeetingSchema);\n\nexport default Meeting; "],
  "mappings": "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",
  "names": ["mongoose", "import_mongoose", "mongoose"]
}
